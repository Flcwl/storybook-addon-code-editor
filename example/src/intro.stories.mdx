import { Meta } from '@storybook/addon-docs';
import { Playground } from 'storybook-addon-code-editor';
import * as ExampleLibrary from './index';
import ReactTypes from '!!raw-loader!@types/react/index.d.ts';
import ExampleLibraryTypes from '!!raw-loader!../dist/types.d.ts';
import PlaygroundExampleCode from '!!raw-loader!./playgroundExample.source.tsx';
import './playgroundExample.css';

<Meta
  title="Code Playground"
  parameters={{
    viewMode: 'docs',
    previewTabs: { canvas: { hidden: true } },
  }}
/>

# storybook-addon-code-editor

`storybook-addon-code-editor` is a Storybook addon to view and live edit code examples.

<p>
  <a href="https://github.com/JeremyRH/storybook-addon-code-editor" target="_blank">
    View on GitHub
  </a>
</p>

## Get started

Install as a dev dependency.

```sh
npm install --save-dev storybook-addon-code-editor
```

Add `storybook-addon-code-editor` in your `.storybook/main.js` file:

```js
module.exports = {
  addons: [
    'storybook-addon-code-editor',
    ...
```

<p>
  See{' '}
  <a
    href="https://github.com/JeremyRH/storybook-addon-code-editor/tree/main/example"
    target="_blank"
  >
    /example
  </a>{' '}
  for usage.
</p>

## Showcase

<>
  {(() => {
    const code = 'export default () => <h1>Simple example</h1>;';
    return (
      <Playground
        code={`
/* MDX:
import { Playground } from 'storybook-addon-code-editor';
<Playground code="${code}" />
*/\n
${code}
    `.trim()}
      />
    );
  })()}
</>

---

<>
  {(() => {
    const code = `
/* MDX:
import { Playground } from 'storybook-addon-code-editor';
import ReactTypes from '!!raw-loader!@types/react/index.d.ts'; // Webpack
import ExampleLibraryTypes from '!!raw-loader!../dist/types.d.ts'; // Webpack
import PlaygroundExampleCode from '!!raw-loader!./playgroundExample.source.tsx'; // Webpack
import './playgroundExample.css';\n
<Playground
  code={PlaygroundExampleCode}
  availableImports={{
    'example-library': ExampleLibrary,
    './playgroundExample.css': {},
  }}
  height="560px"
  onCreateEditor={(editor, monaco) => {
    editor.getModel().updateOptions({ tabSize: 2 });
    monaco.editor.setTheme('vs-dark');
    monaco.languages.typescript.typescriptDefaults.addExtraLib(
      ReactTypes,
      'file:///node_modules/react/index.d.ts'
    );
    monaco.languages.typescript.typescriptDefaults.addExtraLib(
      ExampleLibraryTypes,
      'file:///node_modules/example-library/index.d.ts'
    );
  }}
/>
*/\n
${PlaygroundExampleCode}
  `.trim();
    return (
      <Playground
        code={code}
        availableImports={{
          'example-library': ExampleLibrary,
          './playgroundExample.css': {},
        }}
        height="560px"
        onCreateEditor={(editor, monaco) => {
          editor.getModel().updateOptions({ tabSize: 2 });
          monaco.editor.setTheme('vs-dark');
          monaco.languages.typescript.typescriptDefaults.addExtraLib(
            ReactTypes,
            'file:///node_modules/react/index.d.ts'
          );
          monaco.languages.typescript.typescriptDefaults.addExtraLib(
            ExampleLibraryTypes,
            'file:///node_modules/example-library/index.d.ts'
          );
        }}
      />
    );
  })()}
</>

Getting file contents as strings is different between Webpack and Vite:

```js
import ReactTypes from '!!raw-loader!@types/react/index.d.ts'; // Webpack
import ReactTypes from '@types/react/index.d.ts?raw'; // Vite
```
